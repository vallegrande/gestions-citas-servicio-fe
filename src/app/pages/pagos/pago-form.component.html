<div class="pago-form-page">
  <!-- Header elegante -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-icon">
        <span class="icon-circle">‚úèÔ∏è</span>
      </div>
      <div class="header-text">
        <h1 class="page-title">Actualizar Pago</h1>
        <p class="page-subtitle">Modifica el m√©todo de pago y el estado</p>
      </div>
    </div>
  </div>

  <!-- Formulario con dise√±o moderno -->
  <div class="form-container" *ngIf="pago && !loading">
    <form [formGroup]="form" (ngSubmit)="submit()" class="pago-form">
      
      <!-- Secci√≥n: Informaci√≥n de la Cita (Solo lectura) -->
      <div class="form-section info-section">
        <div class="section-header">
          <div class="section-icon-wrapper">
            <span class="section-icon">üìã</span>
          </div>
          <div class="section-info">
            <h3 class="section-title">Informaci√≥n de la Cita</h3>
            <p class="section-description">Datos de la cita asociada a este pago</p>
          </div>
        </div>
        
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">
              <span class="info-icon">üë§</span>
              Cliente
            </div>
            <div class="info-value">{{ getClienteNombre() }}</div>
          </div>

          <div class="info-item">
            <div class="info-label">
              <span class="info-icon">üõ†Ô∏è</span>
              Servicio
            </div>
            <div class="info-value">{{ getServicioNombre() }}</div>
          </div>

          <div class="info-item">
            <div class="info-label">
              <span class="info-icon">üìÖ</span>
              Fecha de Cita
            </div>
            <div class="info-value">{{ getFechaCita() }}</div>
          </div>

          <div class="info-item">
            <div class="info-label">
              <span class="info-icon">üíµ</span>
              Monto
            </div>
            <div class="info-value amount">S/ {{ getMonto() | number:'1.2-2' }}</div>
          </div>

          <div class="info-item">
            <div class="info-label">
              <span class="info-icon">üìÜ</span>
              Fecha de Registro
            </div>
            <div class="info-value">{{ getFechaPago() }}</div>
          </div>
        </div>

        <div class="info-note">
          <span class="note-icon">‚ÑπÔ∏è</span>
          <span class="note-text">Este pago se cre√≥ autom√°ticamente al registrar la cita. Los datos de la cita y el monto no pueden modificarse.</span>
        </div>
      </div>

      <!-- Secci√≥n: Actualizar Pago -->
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon-wrapper">
            <span class="section-icon">üí∞</span>
          </div>
          <div class="section-info">
            <h3 class="section-title">Actualizar Informaci√≥n del Pago</h3>
            <p class="section-description">Modifica el m√©todo de pago y el estado</p>
          </div>
        </div>
        
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label" for="metodoPago">
              <span class="label-icon">üí≥</span>
              <span class="label-text">M√©todo de Pago</span>
              <span class="required">*</span>
            </label>
            <select 
              id="metodoPago"
              formControlName="metodoPago" 
              class="form-control"
              [class.is-invalid]="form.get('metodoPago')?.touched && form.get('metodoPago')?.invalid">
              <option value="">Seleccione m√©todo de pago</option>
              <option *ngFor="let metodo of metodosPago" [value]="metodo.value">
                {{ metodo.label }}
              </option>
            </select>
            <div class="invalid-feedback" *ngIf="form.get('metodoPago')?.touched && form.get('metodoPago')?.invalid">
              <span class="error-icon">‚ö†Ô∏è</span>
              Debe seleccionar un m√©todo de pago
            </div>
            <small class="form-hint">
              <span class="hint-icon">üí°</span>
              Selecciona c√≥mo se realiz√≥ o realizar√° el pago
            </small>
          </div>

          <div class="form-group">
            <label class="form-label" for="estado">
              <span class="label-icon">üîÑ</span>
              <span class="label-text">Estado del Pago</span>
              <span class="required">*</span>
            </label>
            <select 
              id="estado"
              formControlName="estado" 
              class="form-control"
              [class.is-invalid]="form.get('estado')?.touched && form.get('estado')?.invalid">
              <option *ngFor="let estado of estadosPago" [value]="estado.value">
                {{ estado.label }}
              </option>
            </select>
            <div class="invalid-feedback" *ngIf="form.get('estado')?.touched && form.get('estado')?.invalid">
              <span class="error-icon">‚ö†Ô∏è</span>
              Debe seleccionar un estado
            </div>
            <small class="form-hint">
              <span class="hint-icon">üí°</span>
              <strong>PENDIENTE:</strong> A√∫n no pagado | <strong>PAGADO:</strong> Pago completado | <strong>REEMBOLSADO:</strong> Dinero devuelto
            </small>
          </div>
        </div>
      </div>

      <!-- Secci√≥n: Observaciones -->
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon-wrapper">
            <span class="section-icon">üìù</span>
          </div>
          <div class="section-info">
            <h3 class="section-title">Observaciones</h3>
            <p class="section-description">Informaci√≥n adicional sobre el pago (opcional)</p>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="observaciones">
            <span class="label-icon">üí¨</span>
            <span class="label-text">Observaciones</span>
            <span class="optional">(Opcional)</span>
          </label>
          <textarea 
            id="observaciones"
            formControlName="observaciones" 
            class="form-control"
            placeholder="Observaciones adicionales (opcional)"
            rows="3"></textarea>
          <small class="form-hint">
            <span class="hint-icon">üí°</span>
            Puedes agregar notas o detalles adicionales sobre el pago
          </small>
        </div>
      </div>

      <!-- Botones de acci√≥n con dise√±o mejorado -->
      <div class="form-actions">
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="loading || form.invalid">
          <span class="btn-content">
            <span class="btn-icon" *ngIf="loading">
              <span class="spinner"></span>
            </span>
            <span class="btn-icon" *ngIf="!loading">üíæ</span>
            <span class="btn-text">{{ loading ? 'Guardando...' : 'Actualizar Pago' }}</span>
          </span>
        </button>
        
        <button 
          type="button" 
          class="btn btn-secondary" 
          (click)="cancelar()"
          [disabled]="loading">
          <span class="btn-content">
            <span class="btn-icon">‚Ü©Ô∏è</span>
            <span class="btn-text">Cancelar</span>
          </span>
        </button>
      </div>

      <!-- Mensaje de error con dise√±o mejorado -->
      <div class="alert alert-danger" *ngIf="error">
        <div class="alert-icon">‚ö†Ô∏è</div>
        <div class="alert-content">
          <div class="alert-title">Error al guardar</div>
          <div class="alert-message">{{ error }}</div>
        </div>
      </div>
    </form>
  </div>

  <!-- Estado de carga -->
  <div class="loading-overlay" *ngIf="loading">
    <div class="loading-content">
      <div class="spinner-large"></div>
      <p class="loading-text">Cargando informaci√≥n del pago...</p>
    </div>
  </div>
</div>
