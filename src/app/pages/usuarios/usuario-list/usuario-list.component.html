<div class="usuario-list">
  <!-- Header de la p√°gina -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Usuarios del Sistema</h1>
      <p class="page-subtitle">Administra los usuarios que pueden acceder al sistema (ADMIN y STAFF)</p>
    </div>
    <button class="btn btn-primary" (click)="nuevo()">
      <span class="btn-icon">‚ûï</span>
      Nuevo Usuario Sistema
    </button>
  </div>

  <!-- Estados de carga y error -->
  <div class="loading-state" *ngIf="loading">
    <div class="spinner"></div>
    <p>Cargando usuarios...</p>
  </div>

  <div class="error-state" *ngIf="error && !loading">
    <div class="error-icon">‚ö†Ô∏è</div>
    <p class="error-message">{{ error }}</p>
    <button class="btn btn-primary" (click)="cargar()">Reintentar</button>
  </div>

  <!-- Lista de usuarios -->
  <div class="usuarios-container" *ngIf="!loading && !error">
    <!-- Estad√≠sticas r√°pidas -->
    <div class="stats-row">
      <div class="stat-item">
        <span class="stat-label">Total Usuarios Sistema:</span>
        <span class="stat-value">{{ usuarios.length }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Administradores:</span>
        <span class="stat-value success">{{ getUsuariosPorRol('ADMIN').length }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Staff:</span>
        <span class="stat-value info">{{ getUsuariosPorRol('STAFF').length }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Activos:</span>
        <span class="stat-value success">{{ getUsuariosPorEstado('ACTIVO').length }}</span>
      </div>
    </div>

    <!-- Tabla de usuarios -->
    <div class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Usuario</th>
            <th>Email</th>
            <th>Rol</th>
            <th>Estado</th>
            <th>Fecha Creaci√≥n</th>
            <th class="actions-column">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let usuario of usuarios; trackBy: trackByUsuario" class="table-row">
            <td class="user-id">{{ usuario.id }}</td>
            <td class="user-info">
              <div class="user-avatar">{{ usuario.username.charAt(0).toUpperCase() }}</div>
              <div class="user-details">
                <div class="user-name">{{ usuario.username }}</div>
                <div class="user-meta">{{ usuario.nombre || 'Sin nombre' }}</div>
              </div>
            </td>
            <td class="user-email">{{ usuario.email || 'Sin email' }}</td>
            <td class="user-role">
              <span class="role-badge" [class.admin]="usuario.rol === 'ADMIN'" [class.staff]="usuario.rol === 'STAFF'">
                {{ usuario.rol }}
              </span>
            </td>
            <td class="user-status">
              <span class="status-badge" [class.active]="usuario.estado === 'ACTIVO'" [class.inactive]="usuario.estado === 'INACTIVO'">
                {{ usuario.estado }}
              </span>
            </td>
            <td class="user-date">{{ usuario.fechaCreacion ? (usuario.fechaCreacion | date:'dd/MM/yyyy') : 'N/A' }}</td>
            <td class="actions-column">
              <div class="action-buttons">
                <button class="btn-action edit" (click)="editar(usuario.id)" title="Editar usuario">
                  ‚úèÔ∏è
                </button>
                <button 
                  class="btn-action toggle" 
                  (click)="toggleActivo(usuario)" 
                  [title]="usuario.estado === 'ACTIVO' ? 'Desactivar usuario' : 'Activar usuario'">
                  {{ usuario.estado === 'ACTIVO' ? 'üîí' : 'üîì' }}
                </button>
                <button class="btn-action delete" (click)="eliminar(usuario.id)" title="Eliminar usuario">
                  üóëÔ∏è
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Estado vac√≠o -->
      <div class="empty-state" *ngIf="usuarios.length === 0">
        <div class="empty-icon">ÔøΩ</div>
        <h3>No hay usuarios del sistema registrados</h3>
        <p>Comienza agregando el primer usuario que podr√° acceder al sistema</p>
        <button class="btn btn-primary" (click)="nuevo()">Crear Primer Usuario Sistema</button>
      </div>
    </div>
  </div>
</div>